<!-- 
Generated by LectureQ (Enhanced Comprehensive Version)
Date: 2025-08-16 04:50:21
Model: qwen3:30b
Output Mode: Comprehensive
-->

<think>
I need to create comprehensive lecture notes for a student who missed class on Week 2, Lecture 2 of COMP SCI 3307/7307 Secure Programming.

Let me analyze the requirements:
- Write natural, flowing notes that synthesize ALL information from BOTH sources (slides and transcript)
- Include EVERY concept, example, and explanation
- Rephrase for clarity without copying verbatim
- Don't skip any algorithms, examples, calculations, or key insights

I'll organize this into a well-structured document with:
1. Clear title including week/lecture info
2. Overview section
3. Hierarchical headers for organization
4. Key insights from transcript formatted as specified
5. Comprehensive coverage of all topics
6. Summary/key takeaways at the end

Let me start by analyzing all content:

From slides, I see:
- Course information (final exam details, RangeForce assessment)
- Threat modeling concepts (STRIDE methodology, PASTA, etc.)
- Data flow diagrams
- Attack trees
- MITRE ATT&CK framework
- Kerckhoff's Principle
- OWASP Top 10 vulnerabilities

From transcript, I see:
- Instructor explanations of all these topics
- Student questions and instructor responses
- Additional examples and clarifications
- Emphasis on practical application

I'll synthesize this into a cohesive document that flows naturally while including every important point.

Let me begin drafting the notes with proper structure:

# Week 2: Lecture 2 - Secure Programming: Threat Modeling & Input Sanitization

## Overview
This lecture covers two main topics for secure programming:
1. **Threat modeling** as a proactive security design approach
2. **Input sanitization and authentication**, focusing on common vulnerabilities like injection attacks

The lecture provides foundational knowledge about cybersecurity concepts, threat modeling methodologies (particularly STRIDE), and practical examples of how to identify and prevent common web application vulnerabilities.

Now I'll create the detailed notes with proper structure, including all key points from both slides and transcript.
</think>

# Week 2: Lecture 2 - Secure Programming: Threat Modeling & Input Sanitization

## Overview
This lecture introduces two critical security concepts for secure software development:
1. **Threat modeling** as a proactive approach to identify potential security threats early in the design phase
2. **Input sanitization and authentication**, focusing on preventing common web application vulnerabilities like injection attacks

The lecture covers foundational cybersecurity terminology, threat modeling methodologies (particularly STRIDE), attack trees, MITRE ATT&CK framework, Kerckhoff's Principle, OWASP Top 10 vulnerabilities, and practical examples of security flaws in web applications.

---

## Cybersecurity Fundamentals: Key Terminology

Before diving into threat modeling, it's essential to understand these core cybersecurity concepts:

### The CIA Triad
The foundation for all security considerations:
- **Confidentiality**: Ensuring data is accessible only to authorized users
- **Integrity**: Guaranteeing data remains unaltered by unauthorized parties
- **Availability**: Maintaining system functionality when needed

> *Instructor Insight*: "These three principles form the bedrock of security. If you don't understand these, you'll struggle with everything else in this course."

### Core Security Terminology
| Term | Definition | Example |
|------|------------|---------|
| **Threat** | Potential cause of harm that could exploit a vulnerability | Hacker attempting unauthorized access |
| **Vulnerability** | Weakness or flaw that can be exploited by a threat | Web app not validating input, allowing SQL injection |
| **Exploit** | Action/tool/code taking advantage of a vulnerability to cause harm | Attacker injects `' OR '1'='1' --` into login form |
| **Impact** | Damage resulting from successful exploitation | Breach of sensitive customer data, reputational loss |
| **Risk** | Likelihood that threat will exploit vulnerability considering impact | Probability SQL injection flaw will be exploited |

*Instructor Emphasis*: "Risk = Threat × Vulnerability × Impact. This is the fundamental equation for security risk assessment."

---

## Threat Modeling: A Proactive Security Approach

### Why Threat Model?
- **Identify threats early** in software development (before implementation)
- **Prevent costly fixes later**: Insecure design costs up to 100x more to fix than if addressed during design phase
- **Align security with business objectives**

> *Instructor Insight*: "Threat modeling is like planning your home defense before you build it. You wouldn't wait until intruders are in your house to decide how to secure it."

### Threat Modeling Process (Step-by-Step)
1. **Identify assets** - What needs protection? (Data, systems, business processes)
2. **Define security requirements** based on CIA triad
3. **Create data flow diagrams** showing system components and interactions
4. **Apply threat modeling methodology** (e.g., STRIDE) to identify threats
5. **Evaluate risks** and prioritize mitigation strategies

*Instructor Emphasis*: "The key is to do this *before* writing a single line of code, not after."

---

## STRIDE Methodology: A Practical Threat Modeling Approach

STRIDE was developed by Microsoft in 1999 as a mnemonic for identifying security threats. It categorizes threats into six types:

### STRIDE Elements & Security Properties
| STRIDE Element | Security Property | Description |
|----------------|-------------------|-------------|
| **Spoofing Identity** | Authentication | Verifying user identity (or accepting anonymous users) |
| **Tampering** | Integrity | Ensuring data/system resources changed only appropriately by authorized people |
| **Repudiation** | Nonrepudiation | Preventing users from denying actions they performed |
| **Information Disclosure** | Confidentiality | Restricting access to intended recipients only |
| **Denial of Service (DoS)** | Availability | Maintaining system readiness when needed |
| **Elevation of Privileges** | Authorization | Ensuring explicit permissions for resource access |

> *Instructor Insight*: "Authentication is about verifying who you are. Authorization is about what you're allowed to do after verification."

### Data Flow Diagrams: The Foundation of STRIDE
Data flow diagrams (DFDs) visually represent how data moves through a system:

**Key Components & Rules:**
- **Entities**: External actors interacting with the system (e.g., users, external services)
- **Processes**: Actions or functions within the system
- **Data Stores**: Databases or storage locations
- **Data Flows**: Directional arrows showing data movement

**DFD Construction Rules:**
1. Every entity-entity, entity-data store, and data store-data store must connect via a process
2. Processes must have at least one input and output
3. Use domain-specific names for all components (e.g., "Library System" instead of just "System")

### Building Data Flow Diagrams: Step-by-Step

**Step 1: Context Diagram (Level 0)**
- Identify all external entities interacting with the system
- Show only one process (the entire system)
*Example*: For a library system, entities would include users, librarians, and the website.

**Step 2: System Process Breakdown (Level 1)**
- Split complex processes into sub-processes
- Identify data stores
- Check conditions for each flow
*Example*: The "Library Website" process might break down into:
- User interface handling requests
- Login process
- Database query handler

**Step 3: Further Decomposition (Optional, Level 2+)**
- Continue breaking down processes until you have manageable components

> *Instructor Insight*: "Think of it like peeling an onion. You start with the big picture and gradually reveal more detailed layers as needed."

---

## Practical Threat Modeling Exercise: Library System
Let's apply STRIDE to a library system:

**Scenario**: A normal user can remove books from the database.

- **STRIDE Element**: Elevation of Privileges (or Tampering)
- **Explanation**: The system allows users who shouldn't have this capability (normal users) to perform actions that should only be available to librarians.
- **Why it matters**: This is a classic example where authentication works correctly (users log in), but authorization fails (no check on user type before allowing book removal).

> *Instructor Insight*: "Authentication verifies who you are. Authorization determines what you can do after verification."

**Student Question**: "How does this relate to STRIDE elements?"

*Instructor Response*: "This is a clear case of Elevation of Privileges because normal users shouldn't be able to perform librarian-level actions, and Tampering because they're altering data without proper authorization."

---

## Attack Trees: Modeling Attacks from the Attacker's Perspective

### Key Concepts
Attack trees model threats as decision trees from an attacker's perspective:
- **Capabilities**: What can the attacker do? (e.g., technical skills)
- **Motivation**: Why would they attack? (e.g., financial gain, revenge)
- **Vulnerabilities**: Weaknesses in the system that can be exploited

### Example: Breaking into a Safe
```
Open Safe
├── Find written combination (possible, low cost)
│   └── Look on table/fridge (low effort)
└── Cut open safe (possible, high cost)
    ├── Requires special equipment (expensive)
    └── Needs physical strength (high effort)
```

*Instructor Emphasis*: "Attack trees help you think like an attacker to identify all possible paths they might take."

---

## MITRE ATT&CK Framework

### What It Is
A globally accessible knowledge base of adversary tactics and techniques based on real-world cyber attacks.

### Key Components:
- **Tactics**: High-level objectives (e.g., Initial Access, Execution)
- **Techniques**: Specific methods to achieve those tactics (e.g., Phishing for Initial Access)

> *Instructor Insight*: "MITRE ATT&CK is like a comprehensive playbook of how attackers operate. It helps security teams understand and defend against real-world threats."

*Practical Application*: This framework will be explored further in RangeForce modules.

---

## Kerckhoff's Principle: The Foundation of Secure Design

### Core Concept
> **"Cryptosystems should remain secure even when the attacker knows all internal details of the system. The key should be the only thing that must be kept secret."**

*Instructor Emphasis*: "Never rely on security through obscurity. Assume attackers know everything about your system except the secret keys."

### Why It Matters
- **Common Mistake**: Hardcoding secrets in source code (e.g., passwords, API keys)
- **Correct Approach**: Keep only the key secret; design systems assuming all other details are known

> *Instructor Insight*: "If you're hiding how your system works to prevent attacks, you've already failed. Attackers will find out anyway."

---

## OWASP Top 10: The Most Critical Web Application Vulnerabilities

### Important Notes
- **Top 10 = Risks**, not impacts or vulnerabilities
- Updated every few years (2021 is the 7th update)
- Focuses on common security failures, not specific technical flaws

### OWASP Top 10 Breakdown

#### A01: Broken Access Control
- **Description**: Failure to enforce proper access policies after authentication
- **Examples**:
  - Normal users can delete other users' data
  - Users can perform admin actions without authorization
- **Why it matters**: Directly relates to STRIDE's "Elevation of Privileges" element

#### A02: Cryptographic Failures
- **Description**: Inadequate protection for sensitive data in transit or at rest
- **Examples**:
  - Storing passwords as plaintext
  - Using weak encryption algorithms
  - Missing TLS configuration
- *Instructor Emphasis*: "This isn't just about fancy cryptography—it's about properly protecting data."

#### A03: Injection
- **Description**: Untrusted data sent directly to an interpreter without validation
- **Examples**:
  - SQL injection (exploiting database queries)
  - Command injection (executing arbitrary OS commands)
  - Cross-site scripting (XSS)

> *Instructor Insight*: "Injection flaws occur when you trust user input. Always assume users are attackers."

#### A04: Insecure Design
- **Description**: Security weaknesses in design, not just implementation
- **Key Point**: Costs up to 100x more to fix after development than during design phase
- **Why it matters**: Shift security left—integrate threat modeling early

> *Instructor Insight*: "If you don't model threats before writing code, you're building a house on sand."

#### A05: Security Misconfiguration
- **Description**: Unnecessary features enabled or insecure default configurations
- **Examples**:
  - Default credentials (e.g., admin/admin)
  - Error messages revealing stack traces
  - Unused ports/services

#### A06: Vulnerable and Outdated Components
- **Description**: Using libraries with known vulnerabilities
- **Key Point**: Root cause of largest, most costly breaches
- *Instructor Emphasis*: "This is why the US Executive Order 14028 (Sept. 2022) requires software supply chain transparency."

#### A07: Identification and Authentication Failures
- **Description**: Weak authentication mechanisms or session management
- **Examples**:
  - Allowing common passwords ("Password1", "admin/admin")
  - Missing multi-factor authentication (MFA)
  - Insecure session tokens

> *Instructor Insight*: "If your password is 'password', you've already failed security."

#### A08: Software and Data Integrity Failures
- **Description**: Failure to protect integrity of software or data
- **Examples**:
  - Unverified code updates
  - Missing build verification (SBOM)
  - Unsigned CI/CD pipelines

#### A09: Security Logging and Monitoring Failures
- **Description**: Inadequate logging, detection, or monitoring
- **Why it matters**: Critical for reducing breach window and meeting legal requirements

> *Instructor Insight*: "If you can't detect a breach, how will you respond to it?"

#### A10: Server-Side Request Forgery (SSRF)
- **Description**: Web application fetching remote resources without validating user-supplied URLs
- **Why it matters**: Added as #1 in community survey due to high exploit potential

> *Instructor Insight*: "This is why you should never trust a URL from an unverified source."

---

## Input Sanitization & Authentication: Practical Vulnerabilities

### Web Application Architecture Overview
```
Client (Browser) → Server (Web App) → Database
          |               |
        GET/POST Requests   Queries
```

**Request Types**:
- **GET**: For requesting resources (e.g., `?id=5`)
- **POST**: For form submissions and sensitive data

---

## Injection Attacks: The Core Problem

### Definition
> "Injection flaws occur when an application sends untrusted data to an interpreter."

*Instructor Emphasis*: "This is the most common web vulnerability. If you don't validate input, you're inviting attackers in."

### Example: Command Injection (Ping Vulnerability)

**Vulnerable Code**:
```php
$t = $_REQUEST['ip'];
$o = shell_exec('ping -C 3 ' . $t);
echo $o;
```

**Attack Vector**: `127.0.0.1; ls`  
*(Semicolon separates commands, so it executes both ping and list files)*

**Resulting Command**:
```bash
ping -C 3 127.0.0.1; ls
```

**Exploit Impact**: Attacker can execute arbitrary system commands.

> *Instructor Insight*: "This is why you should never trust user input directly in command execution."

### SQL Injection: The Most Famous Example

#### Vulnerable Code:
```php
$id = $_GET['id'];
$getid = "SELECT first_name, last_name FROM users WHERE user_id = $id";
$result = mysql_query($getid) or die(mysql_error());
```

**Attack Vector**: `1 OR 1=1;#`  
*(The semicolon ends the query, and # comments out the rest)*

**Resulting Query**:
```sql
SELECT first_name, last_name FROM users WHERE user_id = 1 OR 1=1;
```

**Impact**: Returns all user data (not just one user).

#### Why Quotes Don't Fully Fix It:
```php
$getid = "SELECT ... WHERE user_id = '$id'";
```
Attack Vector: `1' OR '1'='1';#`  
*(Quotes are escaped, but comment syntax bypasses the check)*

**Resulting Query**:
```sql
SELECT ... FROM users WHERE user_id = '1' OR '1'='1';#
```

> *Instructor Insight*: "This is why prepared statements (separating query from data) are essential."

---

## Cross-Site Scripting (XSS)

### Types of XSS
| Type | Description | Example |
|------|-------------|---------|
| **Non-Persistent/Reflected** | Malicious code embedded directly in URL, reflected immediately to user | `https://example.com/search?q=<script>alert('xss')</script>` |
| **Persistent/Stored** | Malicious script stored on server (e.g., in database), executed for all users viewing the content | User posts comment with `<script>...</script>` |

*Instructor Emphasis*: "XSS is dangerous because it executes code in *your user's browser*, not your server."

---

## Cross-Site Request Forgery (CSRF)

### How It Works
1. User logs into bank.com (sets session cookie)
2. Attacker tricks user to click malicious link: `bank.com/transfer?amount=10000&dest=evilcorp`
3. Browser sends request with valid session cookie
4. Bank processes transfer without user's knowledge

### Why It Matters
- Requires **user interaction** (clicking a link)
- Requires **active session** on target site
- Different from XSS: CSRF exploits *existing authenticated sessions*, not browser vulnerabilities

> *Instructor Insight*: "CSRF is like someone tricking you into signing a document while you're already logged in to your bank."

---

## Assessment Information (Critical for Students)

### Final Exam Details
- **Format**: Closed book, 40% hurdle requirement
- **Allowed Items**:
  - One A4 double-sided page of handwritten/printed notes
  - Four-function calculator without alphanumeric memory
- **Question Types**:
  - Multiple choice
  - Fill-in-the-blank (usually ≤3 words)
  - Essay questions requiring vulnerability identification and mitigation

*Instructor Emphasis*: "The sample exam is just a template—don't memorize it. Focus on understanding concepts."

---

### RangeForce Assessment Details
| Component | Undergrad (3307) | Postgrad (7307) |
|-----------|------------------|-----------------|
| **Part 1** | 15 points | 10 points |
| **Part 2** | 15 points | 10 points |
| **Challenges** | N/A | 10 points |

*Key Requirements*:
- Complete at least 70 out of 79 modules in Parts 1 & 2
- For postgrads: Complete at least 5 out of 9 Challenges modules

> *Instructor Insight*: "Start immediately—RangeForce access expires after 6 weeks. Don't wait until the last minute."

---

## Group Project Information (Critical for Students)

- **Deadline**: Form groups by end of this week
- **Group Size**: Maximum 5 students per group
- **Project Focus**: Design a secure communication protocol

*Instructor Emphasis*: "This is your chance to apply security principles. Don't wait—form teams now."

---

## Ethical Considerations (Critical Reminder)

> **"Do not use these tools and methods against real targets! It might be illegal to test your own network in some countries."**

*Instructor Emphasis*: "Always follow ethical guidelines: Use virtual machines or sandbox environments only. Never attack systems without explicit permission."

---

## Summary & Key Takeaways

### Core Security Principles
1. **Kerckhoff's Principle**: Assume attackers know everything except secret keys.
2. **Threat Modeling Early**: Identify threats before coding (STRIDE methodology).
3. **Input Validation is Non-Negotiable**: Never trust user input directly.

### Critical Vulnerabilities to Avoid
| OWASP Category | Key Risk | Prevention |
|----------------|----------|------------|
| A01: Broken Access Control | Users performing unauthorized actions | Implement proper authorization checks |
| A02: Cryptographic Failures | Sensitive data exposed | Encrypt in transit and at rest |
| A03: Injection | Unvalidated input executed as code | Use parameterized queries/prepared statements |
| A04: Insecure Design | Security ignored until late stage | Integrate threat modeling early |

### Practical Application
- **For any user input**: Validate, sanitize, and escape before use.
- **For authentication**: Enforce strong passwords and MFA.
- **For data storage**: Encrypt sensitive information.

---

## Study Questions

1. Explain Kerckhoff's Principle in your own words and why it matters for secure design.
2. Describe the difference between authentication and authorization with an example from the library system.
3. How would you apply STRIDE to a banking application? Provide one threat per STRIDE element.
4. What is the fundamental reason SQL injection occurs, and how can it be prevented?
5. Why does OWASP consider "Insecure Design" as a critical category (A04)?
6. Explain why command injection in the ping example would fail if proper input validation was implemented.
7. How do XSS and CSRF differ in their attack mechanisms? Provide an example of each.
8. What is the significance of MITRE ATT&CK for security professionals?
9. Why does Kerckhoff's Principle make hard-coded secrets (e.g., passwords in code) a critical vulnerability?
10. Describe how you would build a data flow diagram for a simple e-commerce website.

---

## Practical Exercises

### Exercise 1: STRIDE Analysis
Take an online shopping application and identify:
- One threat related to Spoofing Identity
- One threat related to Tampering
- One threat related to Information Disclosure

### Exercise 2: SQL Injection Prevention
Rewrite this vulnerable PHP code using prepared statements:

```php
$id = $_GET['id'];
$query = "SELECT * FROM products WHERE id = $id";
$result = mysql_query($query);
```

### Exercise 3: XSS Defense
How would you prevent reflected XSS in a search feature?
- Current implementation: `<input type="text" name="search">`
- Vulnerable code: `echo "You searched for: " . $_GET['search'];`