<!-- 
Generated by LectureQ (Enhanced Comprehensive Version)
Date: 2025-08-16 04:26:31
Model: qwen3:30b
Output Mode: Comprehensive
-->


# Comprehensive Study Notes: Passwords (Chapter 3)

## Introduction to Password Management Systems

### Psychology and Usability of Passwords
Passwords represent one of "the biggest practical problems facing security engineers since perhaps the 1970s" as noted by usability researcher Angela Sasse. This is due to fundamental limitations in human memory:

- **Human Memory Constraints**:
  - People cannot remember infrequently-used or frequently-changed items
  - We can't forget on demand (memory works through recall, not intentional forgetting)
  - Recall is harder than recognition
  - Non-meaningful words are more difficult to remember

> "It's hard to think of a worse authentication mechanism than passwords, given what we know about human memory."

### The Marketing Ecosystem Driving Password Requirements
Most password requirements exist for marketing purposes rather than security:

- Websites seek to maximize page views and registered user bases (to increase value when sold)
- Example: News sites force registration before allowing comments or access to content
  - User journey: Click → Ad page → Form submission with email → CAPTCHA failure → More ads → Email verification link → Another ad → Comment that "nobody will ever read"
  
> This ecosystem is described in detail by Ryan Holiday.

## Components of a Modern Password Management System

| Component | Description |
|-----------|-------------|
| **Visible Logon Page** | Asks for password during registration, checks strength; requests password at login |
| **Recovery Mechanisms** | Deal with forgotten passwords (security questions, primary email recovery, SMS) |
| **Technical Protocol Mechanisms** | Encrypt passwords when entered and compare locally or remotely |
| **Synchronization Protocols** | Sync across platforms so changing on one device affects others; enable blacklisting stolen devices |
| **Intrusion-Detection Systems** | Alert if password used in unusual locations (e.g., Google detecting login from Peru while user is in Scotland) |
| **Single Sign-On Mechanisms** | Use one logon for multiple websites (Google/Facebook authentication) |

> *Key Insight*: Large firms can implement better security due to scale - they detect breaches faster and have resources for sophisticated intrusion detection.

## Password Recovery Systems

### Security Questions: The Insecure Alternative
Security questions like "mother's maiden name" or "favorite team" are problematic:

- **2008 Sarah Palin Hack**: A student hacked her Yahoo account using publicly available information (date of birth, first school)
- **Google Analysis (2015)**:
  - 37% provided wrong answers to security questions
  - 16% had public answers
  - 40% couldn't recall answers when needed
  - Twice as many could recover accounts using SMS reset codes

> "Security questions turned out to be hard to use: 40% of English-speaking US users were unable to recall the answers when needed."

### Email Recovery vs. Two-Factor Authentication (2FA)
- **Email recovery**: Common but vulnerable if email account compromised
- **SMS-based 2FA**:
  - Stops 96% of bulk password guessing by bots
  - Stops 76% of targeted attacks
- **App-based authenticators** (e.g., Google Authenticator):
  - Stop 99% of bulk phishing and 90% of targeted attacks

> *Critical Vulnerability*: SIM swap attacks have become prevalent, where attackers impersonate users to get replacement SIM cards. This became the main form of bank fraud in Nigeria before spreading globally.

## Password Choice: Three Fundamental Concerns (in order of importance)

| Priority | Issue | Explanation |
|----------|-------|-------------|
| **1** | Will user enter password correctly with high probability? | Complex passwords cause entry errors, especially on mobile devices; affects safety-critical systems |
| **2** | Will user remember the password or write it down/choose easy ones for attackers? | Memory limitations lead to predictable patterns (e.g., "julia03" for March) |
| **3** | Will user disclose password accidentally, intentionally, or via deception? | Social engineering attacks exploit this vulnerability |

## Psychological Challenges with Passwords

### 1. Difficulties with Reliable Password Entry
- **Mobile Device Challenge**: Complex rules (e.g., "at least one lower-case letter, upper-case letter, number and special character") are fiddly on smartphones
- **STS Prepayment Meters Case Study**:
  - Customers received a 20-digit code to enter at home meter keypad
  - Illiteracy wasn't the problem; entry errors were (solved by printing in two rows: three groups of four digits, then two)
  
> "Even people who could not read had no difficulty with numbers ('everybody can use a phone')"

- **Nuclear Weapons Firing Codes**:
  - Only 12 decimal digits
  - Maximum reliably conveyable under extreme stress

### 2. Difficulties with Remembering Passwords
#### Naïve Choice of Passwords (Historical Examples)
| Era | Example | Study Findings |
|-----|---------|----------------|
| **Mid-1980s** | Spouses' names, single letters, empty string ("carriage return") | Early Unix systems had many weak passwords |
| **Unix System Analysis (Dennis Ritchie)** | "dmac" (middle name), "wendy!!!" (Eric Schmidt's wife) | 21-25% of passwords could be guessed with effort |
| **Fred Grampp & Robert Morris (1984)** | Passwords like "password", "password1", common female names + digit | After enforcing non-letter requirement, most popular became "password1" |

#### Joe Bonneau's 2012 Study
- Analyzed tens of millions of passwords from leaked files and live statistics on 70 million Yahoo users
- Found:
  - Dictionary words: 7.4%
  - Common names: 4%
  - Account name combinations: 2.7%
  - Science fiction terms: 0.4%
  - Sports terms: 0.2%

> "The largest academic study of password choice... informed the design of current practices at big service firms."

### User Abilities and Training
**Experimental Study (Anderson et al.)**: Three groups trained differently:
- **Red Group**: Standard advice ("password ≥6 chars, includes non-letter")
- **Green Group**: Use passphrases to build passwords (e.g., "It's 12 noon and I am hungry" → "I'S12&IAH")
- **Yellow Group**: Randomly select characters from a table

**Results**:
| Metric | Red vs Green | Yellow |
|--------|--------------|--------|
| Guessability | Similar effectiveness (both better than red) | Most difficult to guess |
| Reset Rates | No significant difference between groups | Highest reset rate |
| Memorability | 30% of control group passwords easily guessed; other two groups had ~10% | Yellow group significantly harder to remember |

**Conclusions**:
- Passphrases offer best balance: as easy to remember as naive choices, as hard to guess as random
- User compliance is the main issue (≈⅓ don't follow instructions)
- Centrally-assigned passwords work due to enforced compliance rather than randomness

### Design Errors in Password Systems
1. **"Mother's Maiden Name" Security Questions**:
   - Data shared extensively between companies, making it easy for attackers to obtain
   - Example: Bank asks "What is your mother's maiden name?" but data breaches make this publicly available
   
2. **Contextual Security Information (Bank Case)**:
   - Bank asked business customers value of last cleared check
   - Problem: Accountants had access to checks, making it ineffective for security

3. **Password Overload**:
   - 2007 study showed average user has 6.5 passwords across 3.9 sites
   - Types ~8 passwords daily (decreased with smartphone usage)
   - Many users reuse same password across multiple services
   
> "The password chosen by the customer of your electronic banking system may be known to a Mafia-operated porn site."

### Operational Failures in Password Management

1. **Default Passwords Not Reset**:
   - Chronic problem since 1980s (e.g., dial access systems)
   - IoT devices often remain vulnerable for entire operational life
   - Miraibotnet exploits default passwords on unpatchable software
   
2. **Passwords in Plain Sight**:
   - Case: *R v Gold and Schifreen* (UK, 1980s):
     - Hackers found maintenance password displayed on terminal at exhibition
     - Used it to hack Duke of Edinburgh's email account
     - Led to UK's first Computer Misuse Act

3. **Password Requests for Marketing Purposes**:
   - Most passwords forced by websites are for marketing (to get emails or create "club" feeling)
   - Rational user response: Enter random strings like '123456' when never planning to return
   
4. **Poor Password Storage Systems**:
   - Some systems don't encrypt passwords at all
   - Reports of hackers smuggling backdoors into password management libraries

### Vulnerability to Social-Engineering Attacks
Banks train customers in ways that contradict security best practices:

| Bank Practice | Security Advice Contradicted |
|---------------|------------------------------|
| Sending emails with clickable links for login | "Don't click on email links; always use bookmarks" |
| Using URLs without SSL warnings (for phishing) | "Check the lock symbol before entering credentials" |
| Asking customers to provide security info over phone calls | "Never give out security information by phone" |

**Citibank Example**: Asked customers to disregard and report emails asking for personal information, but then sent an email requesting logon with card number and ATM PIN.

**Halifax Bank Case (2005)**: Sent spam that looked like legitimate communication. When a student contacted the bank's security department about it being phishing, they discovered the URL was genuine.

## Customer Education on Phishing

### The Arms Race Between Banks and Phishers
| Year | Advice Given to Customers | Phisher Adaptation |
|------|---------------------------|--------------------|
| Early 2000s | "Check the English" (in email) | Used banks' own emails with changed URLs |
| Mid-2000s | "Look for lock symbol in URL" | Added fake SSL certificates or graphics of locks on phishing sites |
| Later | "Check last four digits of account number" | Put first four digits into their phishes (constant per bank) |

> "The countermeasures become so complex and counterintuitive that they confuse more and more users – exactly what the phishermen need."

### Effective Phishing Warnings
Research shows warnings are most effective when:
- Specific and concrete: *"This site has been confirmed to contain software designed to steal your bank account details"*
- Not vague/general: *"'Warning - visiting this web site may harm your computer!'*

> "People paid most attention when the warnings were specific... improves compliance from about 35% to about 50%."

## System Issues in Password Security

### Threat Model Taxonomy (Types of Attacks)
| Attack Type | Description |
|-------------|-------------|
| **Targeted attack on one account** | Intruder tries to guess a specific user's password (e.g., rival at office) |
| **Penetrate any account belonging to target** | Enemy hacks any account you own, seeking information for further attacks |
| **Penetrate any account on target system** | Classic phishing case: hacking bank accounts to launder stolen money |
| **Penetrate any account on any system** | Bad guys guessing passwords on email services to send spam from compromised accounts |
| **Use breach of one system to penetrate related ones** | Intruder gets beachhead and moves inland for higher-value targets |
| **Service-denial attack** | Attacker blocks legitimate users (targeted or system-wide) |

### Dealing with Password Guessing
Three approaches:
1. **Lockout**: Freeze account after 3 wrong attempts (risky - enables DoS attacks)
2. **Throttling**: Limit rate of login attempts (more common for commercial sites)
3. **Protective Monitoring**: Monitor and adjust security measures during crisis

> "Popular, growing, competent sites tend to be more secure... as do payment sites."

### Protecting Users from Each Other
- Systems must prevent legitimate users from compromising others' accounts
- Personal aspect: Passwords chosen by victims of intimate partner abuse are often easy for partners to guess
- System aspect:
  - Mutual authentication between subsystems (e.g., server-server)
  - Default passwords remain a problem ("changeit" in Java trusted keystore)

## Attacks on Password Entry Systems

### Interface Design Flaws
- **Vertical Keyboards at Head Height**: Makes it easy for pickpockets to watch PIN entry
- **UK Bank Study**: 20% of users never shield their PIN, leading banks to blame customers rather than redesigning devices

### Trusted Path and False Terminal Attacks
- **False Terminal Attack**: Malicious program mimics logon screen; saves password when user reenters it after "wrong password" message
- **Windows Secure Attention Sequence (Ctrl+Alt+Del)**: Originally prevented this but removed in Windows 10 for tablet compatibility

### Technical Defeats of Password Retry Counters
| System | Vulnerability | Attack Method |
|--------|---------------|--------------|
| PDP-10 TENEX OS | Checked passwords one character at a time | Timing attack (measured response times to guess characters sequentially) |
| Remote Car Locking Device | Red light on receiver when wrong byte transmitted | Determined correct bytes by observing red light timing |
| Smartcards | Power consumption during PIN retry | Measured current surge from EEPROM write operation |

> "The iPhone kept sensitive data encrypted in flash memory... enabled trying all 10,000 possible PINs rather than the ten limit Apple tried to impose."

## Attacks on Password Storage Systems

### One-Way Encryption (Salted Hashes)
**Correct Implementation**:
- Generate random *salt* for each user
- Combine password with salt using slow cryptographic one-way function
- Store both salt and hash value

> "The right way is to generate a random key... combine the password with the salt using a slow, cryptographically strong one-way function."

### Password Cracking Methods
1. **Dictionary Attacks**: Try all words in dictionary + common patterns (e.g., 'password' → 'password1')
2. **Credential Stuffing**: Use passwords cracked from one system to try on other systems

> "This remains a live problem... when a system is hacked and passwords are cracked, they're then tried out on other systems."

### Remote Password Checking Protocols
| Protocol | Purpose |
|----------|---------|
| Kerberos | Local network authentication; server sends key encrypted under user's password |
| TLS (Transport Layer Security) | Encrypts traffic from browser to web servers |
| SAE (Simultaneous Authentication of Equals) | Newer protocol for WPA3 WiFi standard, designed for guessable passwords |
| OAuth | Allows access delegation ("log in with Google/Facebook") |

> "OAuth... is now used by main service providers such as Google and Microsoft."

## Absolute Limits on Password Security

### Probability Formula
The probability of a successful password guessing attack:
**P = LR/S**

Where:
- **L** = Maximum password lifetime (in seconds)
- **R** = Login attempt rate (attempts per second)
- **S** = Size of the password space

> "For example, if L is 30 days, R is 100 attempts/second, and S is 2^52... P ≈ 0.04."

### Example: Unix Systems
- Traditional 8-character passwords (96^8 = ~2^52)
- UK government systems used fixed templates like CVCNCVCN ("fuR5xEb8")
- If not case-sensitive, guess probability drops to about 1 in 2^29

> "If an attacker could guess 100 passwords per second... they would need about two months."

## Password Managers: Advantages and Disadvantages

### Browser-Based vs Third-Party
| Feature | Browser-Based (e.g., Chrome, Firefox) | Third-Party |
|---------|--------------------------------------|-------------|
| **Security** | Master password encrypts individual site passwords; may not be set by default | May offer stronger security features but some have vulnerabilities |
| **Convenience** | Sync between devices automatically via browser account | More control over backup/recovery procedures |
| **Disadvantages** | All passwords compromised if malware steals from database; banks often disable autocomplete | Some products store secrets in clear text |

### Bank Policies on Password Managers
- Banks try to disable storage (using `autocomplete="off"`) claiming improved security
- Reality: Forces users to create weaker passwords and disables phishing protection

> "Stopping people using password managers... will probably make most of them use weaker passwords."

## Will We Ever Get Rid of Passwords?

### Current Alternatives Being Explored
1. **Physical Tokens** (e.g., CAP reader for bank cards):
   - Requires physical card to log in online banking
   - Bank regulators mandate two-factor authentication

2. **Biometrics**:
   - Fingerprint readers on mobile phones
   - Germany issues ID cards with fingerprints as alternate root of trust

3. **App-Only Authentication** (e.g., Monzo bank):
   - Operates exclusively via app
   - Uses phone security features (fingerprint, pattern lock, PIN)
   - Still relies on email for recovery and authentication during device changes

> "Passwords remain the shaky foundation on which much of information security is built."

### Why Passwords Persist Despite Alternatives
- **Benefits**: Easy to use, efficient, cheap
- **Trade-offs**: Security improvements involve giving up one or more benefits of passwords
- **Current Reality**: Most alternatives still require password fallback for recovery

> "The most popular app that uses SMS to authenticate rather than a password may be WhatsApp."

## Summary: Key Principles in Password Management

1. **Human Factors Matter**:
   - Design systems around human memory limitations, not technical constraints
   - Avoid forcing complex passwords on users who will write them down or choose predictable patterns

2. **Security vs Usability Trade-off**:
   - Strict password policies (monopoly websites) often lead to worse security than relaxed policies with better monitoring (competitive sites)
   - "The only real fix is to design for safe usability in the first place"

3. **Recovery Mechanisms Are Critical Vulnerabilities**:
   - Email recovery creates single point of failure
   - SMS-based 2FA has significant vulnerabilities (SIM swap attacks)

4. **Password Choice Should Be User-Centered**:
   - Passphrases offer best balance between memorability and security
   - Avoid forcing regular password changes

5. **Security Is a Systemic Problem**:
   - Passwords are only one part of the system; need to protect against all attack vectors (storage, entry, recovery)

## Study Questions

1. Explain why passwords represent "one of the biggest practical problems facing security engineers since perhaps the 1970s" based on human memory limitations.

2. Describe three components of a modern password management system and explain how each contributes to overall security or usability.

3. What were the key findings from Google's analysis (2015) regarding "security questions"? How did these findings impact industry practices?

4. Explain why SMS-based two-factor authentication is less secure than app-based authenticators, using specific statistics provided in the text.

5. Describe Anderson et al.'s experimental study comparing three password training methods and explain its implications for security policy design.

6. What are "credential stuffing" attacks? How do they differ from traditional brute-force password guessing?

7. Explain how a timing attack on password entry systems works, using specific examples provided in the text (PDP-10 TENEX system).

8. Describe three different types of social-engineering attacks related to passwords and explain why banks' security practices often exacerbate these vulnerabilities.

9. What is the formula for calculating probability of successful password guessing? Apply it to a hypothetical scenario with L=365 days, R=1 attempt/second, S=2^40.

10. Why do many organizations fail to reset default passwords on devices and systems?

11. Explain why "mother's maiden name" is an insecure security question despite being commonly used for years.

12. Describe the difference between a targeted attack on one account versus penetration of any account on a target system, with examples from the text.

13. What are the advantages and disadvantages of browser-based password managers compared to third-party options?

14. Explain why banks' attempts to disable autocomplete features in web forms may actually decrease security for customers.

15. Describe three different approaches organizations can use when dealing with detected password guessing attempts, including their pros and cons.

16. What is the "resurrecting duckling" authentication approach mentioned at the end of the chapter? How does it differ from traditional password-based systems?

17. Explain why NIST's initial recommendation for monthly password changes was later retracted in 2017, using evidence provided in the text.

18. Describe a real-world case study (from the textbook) where poor interface design led to security vulnerabilities related to passwords.

19. What is "credential stuffing" and how does it exploit human behavior regarding password reuse?

20. Explain why some banks try to disable storage of login credentials, despite evidence that this may lead users to create weaker passwords.
