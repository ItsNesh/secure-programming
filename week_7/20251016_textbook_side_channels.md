<!-- 
Generated by LectureQ (Enhanced Comprehensive Version)
Date: 2025-10-16 01:01:52
Model: qwen3:30b
Output Mode: Comprehensive
-->

I need to create comprehensive study notes based on a textbook chapter about side channels. The chapter covers various types of side channel attacks including electromagnetic emissions (Tempest), power analysis, timing attacks, and environmental side channels.

Let me break down the content into sections for my study notes:

1. Introduction to Side Channels
2. Emission Security (Emsec)
   - History
   - Technical Surveillance and Countermeasures
3. Passive Attacks
   - Leakage through Power and Signal Cables
   - Leakage through RF Signals
4. Attacks Between and Within Computers
   - Timing Analysis
   - Power Analysis
   - Glitching and Differential Fault Analysis
   - Rowhammer, CLKscrew, Plundervolt
   - Meltdown, Spectre, and other Enclave Side Channels
5. Environmental Side Channels
   - Acoustic Side Channels
   - Optical Side Channels
   - Other Side-Channels (Thermal, Accelerometer)
6. Social Side Channels

I'll now create detailed study notes covering all these concepts with explanations of every concept, theory, principle, example, and case study mentioned in the textbook.

Let me start by creating a comprehensive outline for my study notes.
</think>

# Comprehensive Study Notes: Chapter 19 - Side Channels

## Introduction to Side Channels

### Core Concepts
- **Side Channel**: Information leakage accidentally via some medium not designed or intended for communication. *Not deliberate* (unlike covert channels).
  
- **Covert Channel**: Deliberate information leak through a channel that was not meant for communication.

> "Optimisation consists of taking something that works and replacing it with something that almost works but is cheaper." - Roger Needham

### Key Side Channel Attack Examples
1. **Conducted/Radiated Electromagnetic Signals** (Tempest attacks)
   - Led NATO governments to spend billions annually on shielding equipment from 1960s-1990s.
   - After Cold War, people realized "nobody was listening."

2. **Side Channels Between Tasks/Devices**
   - Exploiting power and timing information or contention for shared resources.
   - *Example*: Differential Power Analysis (DPA) discovered in late 1990s held up smartcard deployment by 2-3 years.

3. **Speculative Execution Attacks** 
   - *Examples*: Spectre and Meltdown attacks (Jan 2018)
   - Exploit CPU speculative execution to enable one process to snoop on another.
   - Will force redesign of all superscalar CPUs over 2020-2025.

4. **Shared Local Physical Resources**
   - *Examples*: 
     - Phone listening to keystrokes entered on nearby keyboard
     - Laser pulse creating a click on microphone (voice command through window)
     - Microphone sensors in phones capturing sound

5. **Social Side Channels**
   - Identifying someone from anonymous datasets using communication patterns, location history.
   - *Example*: Medical data leaks leading to privacy issues despite anonymization attempts.

> "We have known about side channels for years but have consistently underestimated the importance of some, while spending unreasonable sums on defending against others."

## 19.2 Emission Security (Emsec)

### Core Concepts
- **Emission Security**: Preventing attacks using compromising emanations (conducted or radiated electromagnetic signals).
  
- **Compromising Emanations**: Unintentional RF emissions that can be intercepted to reconstruct data.

- **Tempest Attacks**: Exploiting stray RF emitted by computers/electronic equipment to reconstruct processed data. Military term for this type of attack.

### History
| Era | Key Events |
|-----|------------|
| 1884-1885 | First known combat exploit: WWI field telephone wires ran parallel to enemy trenches, causing crosstalk (messages from enemy side) |
| Early 1900s | Earth leakage caused crosstalk; listening posts established. Twisted-pair cables introduced for protection by 1915 |
| WWII Era | Intelligence community discovered side-channel attacks on cryptographic equipment (e.g., Bell mixer leaking plaintext in ciphertext) |
| 1957 | KW-27 cipher machine "reasonably well protected" against Tempest emissions |
| 1960s | NATO began work on Tempest standards; USA/UK gave European allies selective security advice to spy on them. Russians developed proficiency at exploiting spurious emissions |
| 1967-1970 | Rand Corporation reports by Willis Ware first public references to computer data leaking |

### Technical Surveillance and Countermeasures

#### Types of Bugs
| Bug Type | Description | Cost/Range | Example |
|----------|-------------|------------|---------|
| Simple Radio Microphone | Stick under table; battery life constraint (days/weeks) | $10-$50 | Basic eavesdropping device |
| Mains-Powered Device | Draws power from external source, lasts indefinitely | Moderate cost | UK Security Service modified telephone to listen during cipher machine key settings entry |
| Laser Microphone | Shines laser at reflective surface; sound waves modulate reflected light | $100-$500 | Modern version of classic technique |

#### Historical Examples
- **Great Seal Bug (1946)**: Wooden replica Great Seal hung on wall in US ambassador's Moscow office. Contained resonant cavity acting as microphone when illuminated by microwaves from outside.
  
- **IBM Selectric Typewriters**: 16 bugs discovered in US embassy in Moscow (1984); each stored eight key presses and transmitted them later.

#### Countermeasures
| Technique | Description |
|-----------|-------------|
| Surveillance Receivers | Sweep radio spectrum to detect unexplained signals; spot direct-sequence spread spectrum, frequency hoppers |
| Nonlinear Junction Detector | Broadcasts weak RF signal; listens for odd harmonics from nonlinear junctions (transistors/diodes) in equipment |
| Shielded Rooms / SCIFs | Secure Compartmented Information Facilities with acoustic and electromagnetic shielding; required for Top Secret material in NATO countries |

> "After the Obama administration kicked out three dozen Russian diplomats for eavesdropping on US officials' mobile phones, it was reported that Russians had even picked up conversations in unshielded SCIFs by hacking officials' phones."

### Modern Challenges
- **Internet of Things (IoT)**: More devices with sensors = more targets ("Internet of Targets")
  
- **Creepware**: Software installed on target's phone remotely or coercively, recording audio/video

> "The NSA banned Furby toys in its buildings as the Furby remembers and randomly repeats things said in its presence. The Cayla talking doll was banned in Germany as strangers could use it to listen to a child remotely."

## 19.3 Passive Attacks

### Core Concepts
- **Passive Attack**: Opponent exploits electromagnetic signals presented without effort on their part (no active creation of signal).

#### Two Categories:
| Category | Description |
|----------|-------------|
| Conducted Signals | Signal travels through circuit (power line, phone line) - "Hijack" in military terms |
| Radiated RF Signals | Radio frequency energy emitted as radiation - "Tempest" |

> "RF threats often have a conducted component. For example, radio signals from computer can be picked up by power main and conducted into nearby buildings."

### Leakage Through Power & Signal Cables
- **Military Terminology**:
  - *Red Equipment*: Carrying confidential data (needs isolation)
  - *Black Equipment*: Can send signals directly to outside world

> "Equipment with both red and black connections, such as cipher machines, is tricky to get right."

### Leakage Through RF Signals

#### Van Eck Attack
- **Discovery**: Wim van Eck published in 1985 how to reconstruct VDU (video display unit) picture at distance using modified TV set.
  
- **Modern Relevance**:
  - Flat displays also vulnerable; laptop video signal travels through hinge cable
  
- **Dutch Voting Machine Example**: 
    > "In October 2006, a Dutch group opposed to electronic voting machines demonstrated that the machine used to collect 90% of election ballots could be eavesdropped from several tens of meters."

#### Zone System for RF Emissions
| Zone | Distance | Description |
|------|----------|-------------|
| Zone 0 | 1 meter | Should not emit exploitable signals even if opponent in next room with plasterboard wall |
| Zone 1 | 20 meters | Safe from opponents at distance of 5-6 meters (Dutch "Zone 1 - 12dB" criterion) |
| Zone 2 | 120 meters | Typical COTS equipment rating |
| Zone 3 | 1200 meters | Particularly noisy commercial devices |

> "Zoning has greatly cut the costs of emission security. Governments realized they had been wasting billions on shielding everything."

#### Soft Tempest Technology
- **Concept**: Software techniques to filter or mask information-bearing electromagnetic emanations from computer systems.
  
- **Implementation**:
  - Most RF energy concentrated in top spectrum for VDUs
  - Removed top 30% of Fourier transform using low-pass filtering
  
- **Effectiveness**:
  - "Almost imperceptible effect on screen contents"
  - Dramatic difference in emitted RF (see Figures 19.2, 19.3, 19.4, 19.5)
  
> "Using Soft Tempest techniques on VDUs translated to a difference of one zone."

### What Goes Wrong
- **Lockheed Martin Case**: Ignored Tempest standards when installing equipment in US Coast Guard vessels (2007).
  - Defects: wrong cable types, violations of separation rules, incorrect grounding, missing filters
  
> "The ships also had hull cracks, outdoor radios not waterproof, security CCTV didn't provide specified coverage."

- **Smartphone Attacks**: Gabriel Goller and Georg Sigl described in 2015 how to extract private keys from smartphones using passive RF monitoring.

## 19.4 Attacks Between and Within Computers

### Core Concepts
- **Covert Channel**: Allows a process at high level to signal down to low (Butler Lampson, 1973).
  
> "In classical multilevel-secure systems, it was considered good result to get covert channel bandwidth down to one bit per second."

#### Types of Covert Channels
| Type | Description |
|------|-------------|
| Storage Channel | Uses shared resource (disk drive) as signal medium |
| Timing Channel | Uses CPU cycles or other timing information |

> "A high process can keep some shared resource busy at time t_i to signal that i-th bit is 1."

### 19.4.1 Timing Analysis

#### Key Attack: Kocher's RSA Timing Attack (1996)
- **Mechanism**: Public-key algorithms leak key info through timing differences.
  
- **Attack Process**:
  - Guess secret exponent one bit at a time
  - Work through consequences of guess for timing measurements
  - See if it reduces variance in timing

> "By 2003, David Brumley and Dan Boneh implemented a timing attack against Apache using OpenSSL."

#### SSL/TLS Vulnerabilities
- Despite protocol being proven secure late 1990s:
  > "There has been about one attack per year since on its implementation, mostly using side channels."
  
- **Example**: Attack on TLS that extracted private key from remote server by timing ~1 million decryptions.

#### Symmetric-Key Vulnerabilities
- **Rijndael (AES) Timing Attacks**:
  - Based on cache misses during S-box lookup
  
> "A naïve implementation of AES can be broken by observing a few hundred encryptions."

### 19.4.2 Power Analysis

#### Core Concept: Differential Power Analysis (DPA)
- **Discovery**: Paul Kocher adapted timing attack ideas into efficient technique to extract key bits from power traces.
  
> "This was brought forcefully to the industry's attention in 1998 by Paul Kocher."

**How DPA Works**
| Step | Description |
|------|-------------|
| Data Collection | Collect several hundred traces of transactions with target card (known plaintext/ciphertext) |
| Guessing Internal State | For each possible value, guess cipher internal state |
| Partition Traces | Sort power traces into two sets based on guessed input bits |
| Compute Differential Trace | Compare average traces for the two partitions |

**Example: DES Attack**
1. Each round has 8 S-box lookups (6-bit inputs)
2. Guess six input bits to target S-box
3. Separate traces into two groups based on guess
4. Correct guess gives noticeable peak in differential trace

> "The correct input value will typically give a differential trace with a noticeable peak."

**Industry Impact**
- All smartcards then on market appeared vulnerable.
- Attack can be carried out by modified terminal equipment against bank card.

#### Defenses Against DPA
| Defense | Description |
|---------|-------------|
| Session Keys (EMV Protocol) | Key used for MAC is session key derived from master key via counter encryption |
| Randomized Clocking | Makes trace alignment harder |
| Masking | Introduce offsets in each round; recalculate S-boxes to compensate |

> "The more expensive cards have dedicated crypto engines for modular multiplication and DES/AES."

#### Advanced Attacks
- **Template Attack**: Study device's current draw closely, build multivariate Gaussian distribution.
  
- **Electromagnetic Analysis (EMA)**: Move tiny pickup coil over chip surface instead of relying on whole device current.

> "Sergei Skorobogatov's optically-enhanced position-locked power analysis uses laser to illuminate single target transistor."

#### Real-World Example
**Philips Hue Lamp Attack (2016)**
- **Attack**: Improved DPA attack retrieved AES key used for firmware updates.
  
- **Vulnerabilities in Philips System**:
  - Single AES key across millions of devices
  - Same key for CBC and MAC
  - Two bugs in light link protocol

> "Malware could spread chain reaction from one lamp to next; authors showed city like Paris had enough lamps for self-sustaining propagation."

### 19.4.3 Glitching & Differential Fault Analysis (DFA)

#### Core Concept: Inducing Errors
- **Glitches**: Insert transients in power or clock lines.

**Example of Smartcard Vulnerability**
> "One smartcard used in early banking applications had feature that high clock frequency only triggered reset after number of cycles, so transient less likely to cause false alarm."

**How Glitching Works**
1. Replace single clock pulse with two narrow pulses
2. Forces processor to execute NOP instead of intended instruction
3. Enables selective code execution (step over jump instructions)

#### Differential Fault Analysis (DFA)
- **Discovery**: Dan Boneh, Richard DeMillo and Richard Lipton noticed public key algorithms break if random error induced.

**RSA Example**
1. RSA signature: S = h(m)^d mod pq
2. Computed as:
   - Mod p first → S_p
   - Mod q second → S_q
3. If card returns defective signature (S_p correct modulo p, incorrect modulo q):
   > "p = gcd(pq, S_e^p - h(m))"

**Memory Bit Manipulation**
- Eli Biham and Adi Shamir: Set given bit of memory to zero/one.
  
> "By doing encryption, zeroing leading bit, another encryption, seeing if result different..."

#### Laser Glitch Attacks
- **Microphone Attack**: Kevin Fu et al. found firing laser at MEMS microphone causes click (activates voice commands from tens of meters away).

### 19.4.4 Rowhammer, CLKscrew & Plundervolt

#### Rowhammer
- **Discovery**: Yoongu Kim and colleagues (2014) - DRAM vulnerability in 2012/2013 chips.
  
> "Repeatedly accessing a row causes bit flips in physically adjacent rows."

**Attack Process**
1. Hammer specific memory address repeatedly
2. Induce bit flip in neighboring row(s)
3. Exploit to gain kernel privileges (Seaborn & Dullien, 2015)

**Advanced Rowhammer Variants**
- **RAMBleed**: Read as well as write; works even with ECC memory correcting each bit flip.
  
> "Kaveh Razavi and colleagues showed how to use technique to replace strong public key with weak one."

#### CLKscrew
- **Discovery**: Adrian Tang, Simha Sethumadhavan & Sal Stolfo (2017)
  
**Mechanism**: Overclock Arm processor on Nexus 6 to defeat TrustZone.

> "Extracted crypto keys and escalated privilege."

#### Plundervolt
- **Discovery**: Kit Murdock et al. (2019) - Exploits undocumented voltage scaling interface in Intel Core processors.
  
**Effects**
- Undervoltage induces faults during multiply/AES-NI operations
- Allows extraction of RSA/AES keys using fault analysis
- Leaks arbitrary memory contents from SGX enclaves

> "Intel released microcode patches for CLKscrew and Plundervolt, but we may expect other CPU attacks."

### 19.4.5 Meltdown & Spectre (Enclave Side Channels)

#### Core Concept: Speculative Execution
- Modern CPUs fetch multiple instructions ahead; predict branch paths.
  
> "Even if a CPU's execution is formally correct, all sorts of lower-level optimizations can make timing depend on secret data."

#### Meltdown
- **Mechanism**: Race condition between memory access and privilege checking.
  
**How It Works**
1. Create race condition: Memory access before privilege check
2. Read forbidden memory via cache side channel

> "Meltdown reads target process's data directly."

#### Spectre
- **Family of Vulnerabilities**: Exploiting branch prediction logic (special case of speculative execution).
  
**Mechanism**
1. Train CPU to mispredict branches
2. Cause CPU to fetch instructions that would never execute
3. If these perform forbidden operations, protected pages may be fetched from cache

> "Spectre tricks the target process into revealing its data via side-channels."

#### Impact of Meltdown & Spectre (Jan 2018)
- **Hardware Response**: Intel and Arm announced CPU redesigns to block attacks.
  
**Performance Costs**
- Software mitigations may cause ~15% performance hit with some workloads
- Occasional reboots required

> "Given world's data centers consume perhaps 3% of all electric power, this is potentially a big deal."

#### Spectre Variants (Post-2018)
| Attack | Description |
|--------|-------------|
| Foreshadow | Cracks features on Intel processors that Spectre didn't include SGX and system management mode |
| Zombieload | Exploits CPU microarchitecture to leak data from cache lines |
| Fallout | Similar to Zombieload, targets different processor components |
| Smotherspectre | Another variant exploiting speculative execution |
| RAMBleed | Uses Rowhammer-like technique for side-channel attacks on memory |

#### Mitigation Strategies
- **Hardware**: New barrier instructions (CSDB, SSBB, PSSBB)
  
> "After CSDB appears in code, no instruction may be speculatively executed using predicted data or state."

- **Software**: Data field CVS2 from v8.5A onwards to indicate presence of mitigations.

> "It will take perhaps four years to get this all into silicon..."

## 19.5 Environmental Side Channels

### Core Concepts
Environmental side channels exploit human behavior and device environment (acoustics, optics, motion).

#### Acoustic Side Channels
- **Key Research**: Dawn Song et al. (2001) - Keystroke timing contains information for password recovery.
  
> "Encrypted packet timing gives precise inter-keystroke timing... hidden Markov model gives about one bit of info per keystroke pair."

**Acoustic Keylogging**
| Year | Researchers | Method |
|------|-------------|--------|
| 2004 | Asonov & Agrawal | Neural network to recognize keypress sounds (few percent error rate) |
| 2005 | Zhuang, Zhou, Tygar | Combined with English language statistics for full text recovery |
| 2016 | Compagno et al. | Deep neural networks could reconstruct typing while talking on Skype |

**Mobile Phone Attacks**
- **Shumailov (2017)**: One app can recover passwords/PINs typed into another app by listening to screen taps using two microphones.
  
> "Time-difference-of-arrival processing... enables rogue app to steal online banking password."

### Optical Side Channels
#### Shoulder Surfing
- Classic attack where someone watches PIN entry at ATM.

**Advanced Techniques**
| Technique | Description |
|-----------|-------------|
| Ocean (NSA) | Markus Kuhn showed in 2002 that diffuse reflected glow from computer monitor contains screen information. Used telescope + photomultiplier tube to read screens across city. |
| LED Data Transmission | Joe Loughry & David Umphress found LEDs on devices transmit serial data optically: 11/12 modems, 2/7 routers tested transmitted data via LED indicator lights. |
| Lamphone Channel (Nassi et al., 2020) | Speech/music induces vibration in hanging lightbulb; read across street with telescope + photodiode. Passive technique, less sensitive to direction than laser microphone. |

### Other Side Channels
#### Thermal Covert Channels
- **Discovery**: Steven Murdoch (2006)
  
> "Typical computer's clock skew shows diurnal variation... function of ambient temperature."

**Implication**
- Anyone measuring accurate timestamps can measure CPU load.
- Can potentially determine machine location via time zone/seasons.

#### Accelerometer Side Channel
| Researcher | Finding |
|------------|---------|
| Adam Aviv (2013) | Fingerprint residues on touchscreens help break pattern locks; smudges reveal PINs. |
| Shumailov et al. (2017) | Phone's rocking motion as user types reveals significant information. Even while walking, could classify 20% of PINs within 5 attempts. |

**Smartwatch Side Channels**
- **Liu et al. (2015)**: Smartwatches allow accelerometer inference attacks on smartphone PIN entry.
  
> "If worn on left wrist, gets more accuracy with left-hand letters."

#### Social Side Channel Example
- **Pentagon Pizza Delivery**: Increase in pizza deliveries to Pentagon leaking military operation plans.

## 19.6 Social Side Channels

### Core Concept: Information Leakage Through Context
- **Contextual Integrity** (Helen Nissenbaum): Privacy failure occurs when information from one context ends up in another.
  
> "Most privacy failures that do real harm result from information from clinic ending up in newspaper."

#### Real-World Example
- **UK Medical Data Leak**: Woman's visit to GUM (genitourinary medicine) clinic leaked because insurer knew smear test had been done by clinic and didn't want to pay twice.
  
> "The insurer failed to recall her for a smear test that GP knew was due."

#### Policy Implications
- **De-identification Failure**: Multiple scandals show de-identified medical records remain sensitive.
  
> "This is emphatically not the case, as one scandal after another has brought home... leading among other things to EU General Data Protection Regulation (GDPR)."

## 19.7 Summary

### Key Takeaways
| Category | Impact |
|----------|--------|
| **Electromagnetic** | Billions spent on shielding; Tempest attacks still relevant for high-value targets |
| **Power/Timing Analysis** | Major threat to smartcards, crypto implementations (DPA held up banking deployment 2-3 years) |
| **CPU Microarchitecture** | Meltdown/Spectre caused industry-wide redesigns of CPUs over 5+ years; ongoing research into new variants |
| **Environmental** | Acoustic/visual attacks increasingly feasible with smartphone sensors and ML techniques |

> "Side-channel leakage is a huge topic... it will get more complex still as we get software and sensors in just about everything."

## Research Problems & Further Reading

### Current Challenges
- **Complexity**: More complex supply chains make bug fixes harder.
  
- **Performance Trade-offs**: Vulnerabilities often won't be fixed due to performance/cost concerns.

> "Attacks become easier as techniques are honed and software gets passed around."

#### Emerging Trends
1. **Machine Learning Impact**:
   - Improving attacks from Tempest through power analysis
   
2. **Software Radios**:
   > "Softwareradios... no longer an expensive military curiosity but ubiquitous in cellular base stations, GPS receivers, IoT devices..."

3. **Social Side Channels**:
   - Driving research into privacy and data anonymization.

### Key References
| Topic | Author/Reference |
|-------|------------------|
| Tempest History | David Easter [600] |
| Classic Van Eck Article | Wim van Eck [601] |
| Soft Tempest & Teapot | Anderson, Kuhn et al. [1107] |
| Power Analysis Basics | Paul Kocher [1067], Thomas Messergues [1300] |
| Timing/Power Attack Textbook | Mangard, Oswald, Popp [1216] |

## Study Questions

1. What is the difference between a side channel and a covert channel? Provide examples of each from the chapter.

2. Explain how Differential Power Analysis (DPA) works using DES as an example. How many key bits can be extracted in one round?

3. Describe three different types of electromagnetic attacks mentioned in Section 19.3, including their historical context or modern relevance.

4. What is Rowhammer? How does it work and what are its implications for system security?

5. Explain the difference between Meltdown and Spectre vulnerabilities. Why were they so significant to industry?

6. Describe how a "Lamphone" channel works as an optical side channel, including who discovered it and when.

7. What is meant by "contextual integrity" in privacy? How does this concept relate to social side channels discussed in Section 19.6?

8. Explain the zone system for RF emissions (Zone 0-3). Why was this important for voting machines in the Netherlands?

9. Describe how a timing attack on RSA works, including Paul Kocher's contribution and its impact.

10. What is "Soft Tempest" technology? How does it work to prevent side channel attacks?

11. Explain what makes Spectre variants so difficult to mitigate compared to other CPU vulnerabilities.

12. Discuss the implications of acoustic side channels for mobile devices, including specific examples from 2016-2017 research.

13. What is a "glitch" in hardware security? How can it be used as an attack vector?

14. Why did DPA hold up smartcard deployment in banking by 2-3 years according to the text?

15. Describe how thermal side channels could potentially reveal information about a computer's usage patterns.

16. What is "Creepware" and why does it represent a significant threat compared to traditional hardware bugs?

17. Explain what makes Rowhammer attacks particularly dangerous for modern systems, including their potential impact on security mechanisms like public key authentication.

18. How do the authors describe the relationship between side channel research and industry adoption of secure technologies? Provide specific examples from the text.

19. What is meant by "speculative execution" in CPU architecture, and why does it create vulnerabilities for attacks like Spectre?

20. Describe how a smartphone's accelerometer can be used as an unintended side channel to infer user input (e.g., PINs or passwords).